<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lista de Tarefas</title>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: "Inter", Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      background: linear-gradient(135deg, #331F19, #5a3c31);
      margin: 0;
      padding: 40px;
      color: #331F19;
    }

    .container {
      background-color: #CBBBA7;
      padding: 30px;
      border-radius: 16px;
      width: 90%;
      max-width: 700px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
      animation: fadeIn 0.5s ease;
      border: 1px solid #b6a795;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(15px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h1 {
      margin-top: 0;
      letter-spacing: 1px;
      font-size: 2rem;
      text-align: center;
    }

    p {
      font-size: 1.1em;
      opacity: 0.85;
      text-align: center;
    }

    button {
      background-color: #60041A;
      color: #F4F0EA;
      padding: 12px 22px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.25s ease;
      margin-top: 10px;
    }

    button:hover {
      background-color: #8b1f32;
      transform: translateY(-1px);
    }

    input[type="text"],
    input[type="file"] {
      padding: 12px;
      width: 80%;
      max-width: 500px;
      margin: 10px auto;
      display: block;
      border: 2px solid #8B7D70;
      border-radius: 8px;
      font-size: 1em;
      background: #f7f3ee;
      transition: 0.25s ease;
    }

    input[type="text"]:focus {
      border-color: #60041A;
      box-shadow: 0 0 6px rgba(96, 4, 26, 0.3);
    }

    ul {
      list-style: none;
      padding: 0;
      margin-top: 20px;
    }

    li {
      background-color: #F4F0EA;
      color: #331F19;
      padding: 14px 16px;
      margin: 10px 0;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 14px;
      box-shadow: 0 5px 12px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease, background-color 0.2s ease;
    }

    li:hover {
      transform: translateX(4px);
      background-color: #ffffff;
    }

    .thumb {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      object-fit: cover;
      border: 1px solid #8B7D70;
    }

    .controls button {
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 0.85em;
      margin-left: 4px;
    }

    .success {
      color: #2ecc71;
      font-weight: bold;
      margin-top: 5px;
      text-align: center;
    }

    .error {
      color: #c0392b;
      font-weight: bold;
      margin-top: 5px;
      text-align: center;
    }

    .input-error {
      border-color: #c0392b !important;
    }

    .input-success {
      border-color: #2ecc71 !important;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Lista de Tarefas</h1>
    <p>Adicione suas tarefas!</p>

    <div>
      <input type="text" id="inputTarefa" placeholder="Digite a sua tarefa (mín. 5 caracteres)" />
      <input type="file" id="inputImagem" accept="image/png, image/jpeg" />
      <button id="btnAdicionar">Adicionar</button>
    </div>

    <p id="mensagem" aria-live="polite"></p>

    <ul id="listaTarefas"></ul>
  </div>

  <script>
    const input = document.getElementById('inputTarefa');
    const fileInput = document.getElementById('inputImagem');
    const btnAdicionar = document.getElementById('btnAdicionar');
    const mensagem = document.getElementById('mensagem');
    const lista = document.getElementById('listaTarefas');

    const MIN_CHARS = 5;
    let itens = [];

    function mostrarMensagem(texto, tipo) {
      mensagem.textContent = texto;
      mensagem.className = tipo;

      input.classList.remove('input-error', 'input-success');

      if (tipo === 'success') input.classList.add('input-success');
      else if (tipo === 'error') input.classList.add('input-error');

      setTimeout(() => {
        mensagem.textContent = '';
        mensagem.className = '';
        input.classList.remove('input-error', 'input-success');
      }, 2500);
    }

    function gerarId() {
      return Date.now().toString(36) + Math.random().toString(36).slice(2, 7);
    }

    btnAdicionar.addEventListener('click', adicionarTarefa);
    input.addEventListener('keypress', e => {
      if (e.key === 'Enter') adicionarTarefa();
    });

    function adicionarTarefa() {
      const texto = input.value.trim();

      if (texto.length < MIN_CHARS) {
        mostrarMensagem(`Erro: digite ao menos ${MIN_CHARS} caracteres.`, 'error');
        return;
      }

      const file = fileInput.files && fileInput.files[0];

      if (file) {
        const reader = new FileReader();
        reader.onload = () => pushItem(texto, reader.result);
        reader.readAsDataURL(file);
      } else {
        pushItem(texto, null);
      }
    }

    function pushItem(texto, img) {
      itens.push({ id: gerarId(), texto, img });
      renderLista();
      input.value = '';
      fileInput.value = '';
      mostrar mensagem('Tarefa adicionada com sucesso!', 'success');
    }

    function renderLista() {
      lista.innerHTML = '';

      itens.forEach((item, idx) => {
        const li = document.createElement('li');
        li.dataset.id = item.id;

        const thumb = document.createElement('img');
        thumb.className = 'thumb';
        thumb.src = item.img || 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect width="40" height="40" fill="%23eee"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="8" fill="%23888">IMG</text></svg>';

        const textoEl = document.createElement('span');
        textoEl.textContent = item.texto;

        const controls = document.createElement('div');
        controls.className = 'controls';

        const btnEditar = document.createElement('button');
        btnEditar.textContent = 'Editar';
        btnEditar.onclick = () => toggleEditar(item.id, textoEl, btnEditar);

        const btnExcluir = document.createElement('button');
        btnExcluir.textContent = 'Excluir';
        btnExcluir.onclick = () => {
          if (confirm('Excluir esta tarefa?')) {
            itens = itens.filter(i => i.id !== item.id);
            renderLista();
            mostrarMensagem('Item excluído.', 'success');
          }
        };

        const btnUp = document.createElement('button');
        btnUp.textContent = '↑';
        btnUp.onclick = () => {
          if (idx > 0) {
            [itens[idx - 1], itens[idx]] = [itens[idx], itens[idx - 1]];
            renderLista();
          }
        };

        const btnDown = document.createElement('button');
        btnDown.textContent = '↓';
        btnDown.onclick = () => {
          if (idx < itens.length - 1) {
            [itens[idx + 1], itens[idx]] = [itens[idx], itens[idx + 1]];
            renderLista();
          }
        };

        const btnImg = document.createElement('button');
        btnImg.textContent =
