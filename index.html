<!DOCTYPE html>
<html lang="pt-BR">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>Lista de Tarefas com API</title>
Â  <style>
Â  Â  body {
Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: flex-start;
Â  Â  Â  min-height: 100vh;
Â  Â  Â  margin: 0;
Â  Â  Â  background-color: #1F2A38; /* Azul Escuro */
Â  Â  Â  padding: 20px;
Â  Â  }

Â  Â  .container {
Â  Â  Â  text-align: center;
Â  Â  Â  background-color: #E6E9EE; /* Cinza Claro */
Â  Â  Â  padding: 30px;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
Â  Â  Â  width: 90%;
Â  Â  Â  max-width: 800px;
Â  Â  Â  border: 1px solid #C0C8D0;
Â  Â  }

Â  Â  h1 { color: #2C3E50; margin-bottom: 5px; }
Â  Â  p { color: #5B6D7D; font-size: 1.1em; margin-bottom: 20px; }

Â  Â  button {
Â  Â  Â  background-color: #3498DB; /* Azul Claro */
Â  Â  Â  color: white;
Â  Â  Â  padding: 10px 20px;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 5px;
Â  Â  Â  cursor: pointer;
Â  Â  Â  font-size: 1em;
Â  Â  Â  transition: background-color 0.3s ease;
Â  Â  Â  margin-left: 10px;
Â  Â  }
Â  Â  button:hover { background-color: #2980B9; }

Â  Â  .add-section {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;
Â  Â  Â  margin-bottom: 20px;
Â  Â  }

Â  Â  ul {
Â  Â  Â  list-style: none;
Â  Â  Â  padding: 0;
Â  Â  Â  margin-top: 20px;
Â  Â  }

Â  Â  li {
Â  Â  Â  background-color: #F8F9FA;
Â  Â  Â  color: #2C3E50;
Â  Â  Â  padding: 15px;
Â  Â  Â  margin: 10px 0;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  transition: background-color 0.3s ease;
Â  Â  }

Â  Â  .completed {
Â  Â  Â  background-color: #D4EDDA; /* Verde Suave */
Â  Â  Â  color: #155724;
Â  Â  Â  text-decoration: line-through;
Â  Â  Â  opacity: 0.7;
Â  Â  }

Â  Â  .task-text {
Â  Â  Â  flex-grow: 1;
Â  Â  Â  text-align: left;
Â  Â  Â  padding: 0 10px;
Â  Â  }
Â  Â  .task-text input[type="text"] {
Â  Â  Â  width: 90%;
Â  Â  Â  padding: 5px;
Â  Â  Â  border: 1px solid #BDC3C7;
Â  Â  Â  border-radius: 4px;
Â  Â  Â  font-size: 1em;
Â  Â  }

Â  Â  input[type="text"] {
Â  Â  Â  padding: 10px;
Â  Â  Â  width: 60%;
Â  Â  Â  max-width: 500px;
Â  Â  Â  border: 2px solid #BDC3C7;
Â  Â  Â  border-radius: 5px;
Â  Â  Â  font-size: 1em;
Â  Â  Â  outline: none;
Â  Â  Â  transition: border-color 0.3s ease;
Â  Â  }
Â  Â  input[type="text"]:focus {
Â  Â  Â  border-color: #3498DB;
Â  Â  }

Â  Â  .controls button {
Â  Â  Â  background-color: #E74C3C; /* Vermelho */
Â  Â  Â  color: white;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 5px;
Â  Â  Â  padding: 8px 12px;
Â  Â  Â  margin-left: 5px;
Â  Â  }
Â  Â  .controls .edit-btn { background-color: #F39C12; } /* Laranja */
Â  Â  .controls .save-btn { background-color: #27AE60; } /* Verde Escuro */
Â  Â  .controls button:hover { opacity: 0.8; }

Â  Â  #mensagem {
Â  Â  Â  padding: 10px;
Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  border-radius: 5px;
Â  Â  Â  font-weight: bold;
Â  Â  Â  display: none;
Â  Â  }
Â  Â  .success { background-color: #D4EDDA; color: #155724; display: block;}
Â  Â  .error { background-color: #F8D7DA; color: #721C24; display: block;}
Â  Â  .loading { color: #3498DB; display: block; }
Â  </style>
</head>
<body>
Â  <div class="container">
Â  Â  <h1>ğŸ“ Lista de Tarefas (API)</h1>
Â  Â  <p>Tarefas persistidas usando JSONPlaceholder (simulaÃ§Ã£o).</p>

Â  Â  <div id="mensagem" aria-live="polite"></div>

Â  Â  <div class="add-section">
Â  Â  Â  <input type="text" id="inputTarefa" placeholder="Nova tarefa (min. 5 caracteres)" />
Â  Â  Â  <button id="btnAdicionar">Adicionar</button>
Â  Â  </div>

Â  Â  <ul id="listaTarefas">
Â  Â  Â  Â  Â  </ul>
Â  </div>

Â  <script>
Â  Â  const API_URL = 'https://jsonplaceholder.typicode.com/todos';
Â  Â  const MIN_CHARS = 5;

Â  Â  const inputTarefa = document.getElementById('inputTarefa');
Â  Â  const btnAdicionar = document.getElementById('btnAdicionar');
Â  Â  const mensagem = document.getElementById('mensagem');
Â  Â  const listaTarefas = document.getElementById('listaTarefas');

Â  Â  // --- FunÃ§Ãµes de UtilitÃ¡rio ---

Â  Â  function mostrarMensagem(texto, tipo = 'loading') {
Â  Â  Â  mensagem.textContent = texto;
Â  Â  Â  mensagem.className = tipo;
Â  Â  }

Â  Â  // --- FunÃ§Ãµes de IntegraÃ§Ã£o com API ---

Â  Â  async function carregarTarefas() {
Â  Â  Â  mostrarMensagem('Carregando tarefas...');
Â  Â  Â  try {
Â  Â  Â  Â  // Limita a 10 tarefas para melhor visualizaÃ§Ã£o no teste
Â  Â  Â  Â  const response = await fetch(`${API_URL}?_limit=10`);
Â  Â  Â  Â  if (!response.ok) throw new Error('Falha ao carregar a lista.');
Â  Â  Â  Â  const itens = await response.json();
Â  Â  Â  Â  renderLista(itens);
Â  Â  Â  Â  mostrarMensagem('Tarefas carregadas.', 'success');
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Erro ao carregar:', error);
Â  Â  Â  Â  mostrarMensagem(`Erro: ${error.message}`, 'error');
Â  Â  Â  } finally {
Â  Â  Â  Â  // Limpa a mensagem de sucesso/loading apÃ³s um tempo
Â  Â  Â  Â  setTimeout(() => mensagem.className = '', 3000);
Â  Â  Â  }
Â  Â  }

Â  Â  async function adicionarTarefa() {
Â  Â  Â  const texto = inputTarefa.value.trim();
Â  Â  Â  if (texto.length < MIN_CHARS) {
Â  Â  Â  Â  mostrarMensagem(`Erro: digite ao menos ${MIN_CHARS} caracteres.`, 'error');
Â  Â  Â  Â  setTimeout(() => mensagem.className = '', 3000);
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  mostrarMensagem('Adicionando tarefa...');
Â  Â  Â  const novaTarefa = {
Â  Â  Â  Â  title: texto,
Â  Â  Â  Â  completed: false,
Â  Â  Â  Â  userId: 1 // Id de usuÃ¡rio fixo para o exemplo
Â  Â  Â  };

Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(API_URL, {
Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  body: JSON.stringify(novaTarefa)
Â  Â  Â  Â  });
Â  Â  Â  Â  if (!response.ok) throw new Error('Falha ao adicionar no servidor.');

Â  Â  Â  Â  const itemCriado = await response.json();
Â  Â  Â  Â  // A API JSONPlaceholder retorna um ID "fictÃ­cio" (geralmente 201) para POSTs, simulando sucesso.
Â  Â  Â  Â  renderItem(itemCriado, true); // Adiciona o item ao topo
Â  Â  Â  Â  inputTarefa.value = '';
Â  Â  Â  Â  mostrarMensagem('Tarefa adicionada com sucesso!', 'success');

Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Erro ao adicionar:', error);
Â  Â  Â  Â  mostrarMensagem(`Erro: ${error.message}`, 'error');
Â  Â  Â  } finally {
Â  Â  Â  Â  setTimeout(() => mensagem.className = '', 3000);
Â  Â  Â  }
Â  Â  }

Â  Â  async function toggleCompleted(id, isCompleted) {
Â  Â  Â  mostrarMensagem('Atualizando status...');
Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(`${API_URL}/${id}`, {
Â  Â  Â  Â  Â  method: 'PATCH', // Usamos PATCH para atualizar uma parte do recurso
Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  body: JSON.stringify({ completed: isCompleted })
Â  Â  Â  Â  });
Â  Â  Â  Â  if (!response.ok) throw new Error('Falha ao atualizar o status.');

Â  Â  Â  Â  const li = document.querySelector(`li[data-id="${id}"]`);
Â  Â  Â  Â  if (li) {
Â  Â  Â  Â  Â  li.classList.toggle('completed', isCompleted);
Â  Â  Â  Â  }
Â  Â  Â  Â  mostrarMensagem('Status atualizado.', 'success');

Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Erro ao atualizar status:', error);
Â  Â  Â  Â  mostrarMensagem('Erro ao atualizar status da tarefa.', 'error');
Â  Â  Â  } finally {
Â  Â  Â  Â  setTimeout(() => mensagem.className = '', 3000);
Â  Â  Â  }
Â  Â  }

Â  Â  async function editarTarefa(id, novoTitulo) {
Â  Â  Â  mostrarMensagem('Salvando ediÃ§Ã£o...');
Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(`${API_URL}/${id}`, {
Â  Â  Â  Â  Â  method: 'PATCH',
Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  body: JSON.stringify({ title: novoTitulo })
Â  Â  Â  Â  });
Â  Â  Â  Â  if (!response.ok) throw new Error('Falha ao salvar ediÃ§Ã£o.');

Â  Â  Â  Â  mostrarMensagem('EdiÃ§Ã£o salva.', 'success');
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Erro ao editar:', error);
Â  Â  Â  Â  mostrarMensagem('Erro ao salvar a ediÃ§Ã£o.', 'error');
Â  Â  Â  } finally {
Â  Â  Â  Â  setTimeout(() => mensagem.className = '', 3000);
Â  Â  Â  }
Â  Â  }

Â  Â  async function excluirTarefa(id) {
Â  Â  Â  if (!confirm('Tem certeza que deseja excluir esta tarefa?')) return;

Â  Â  Â  mostrarMensagem('Excluindo tarefa...');
Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(`${API_URL}/${id}`, {
Â  Â  Â  Â  Â  method: 'DELETE'
Â  Â  Â  Â  });
Â  Â  Â  Â  // JSONPlaceholder sempre retorna 200/204 para DELETE, simulando sucesso
Â  Â  Â  Â  if (!response.ok) throw new Error('Falha ao excluir no servidor.');

Â  Â  Â  Â  document.querySelector(`li[data-id="${id}"]`).remove();
Â  Â  Â  Â  mostrarMensagem('Tarefa excluÃ­da.', 'success');
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Erro ao excluir:', error);
Â  Â  Â  Â  mostrarMensagem('Erro ao excluir a tarefa.', 'error');
Â  Â  Â  } finally {
Â  Â  Â  Â  setTimeout(() => mensagem.className = '', 3000);
Â  Â  Â  }
Â  Â  }

Â  Â  // --- FunÃ§Ãµes de RenderizaÃ§Ã£o e UI ---

Â  Â  function renderItem(item, prepend = false) {
Â  Â  Â  const li = document.createElement('li');
Â  Â  Â  li.dataset.id = item.id;
Â  Â  Â  li.classList.toggle('completed', item.completed);

Â  Â  Â  // Checkbox
Â  Â  Â  const checkbox = document.createElement('input');
Â  Â  Â  checkbox.type = 'checkbox';
Â  Â  Â  checkbox.checked = item.completed;
Â  Â  Â  checkbox.onchange = (e) => toggleCompleted(item.id, e.target.checked);
Â  Â  Â  li.append(checkbox);

Â  Â  Â  // Texto da Tarefa
Â  Â  Â  const textoWrapper = document.createElement('span');
Â  Â  Â  textoWrapper.className = 'task-text';
Â  Â  Â  textoWrapper.textContent = item.title;
Â  Â  Â  li.append(textoWrapper);

Â  Â  Â  // Controles (BotÃµes)
Â  Â  Â  const controls = document.createElement('div');
Â  Â  Â  controls.className = 'controls';
Â  Â  Â  li.append(controls);

Â  Â  Â  const btnEditar = document.createElement('button');
Â  Â  Â  btnEditar.textContent = 'Editar';
Â  Â  Â  btnEditar.className = 'edit-btn';
Â  Â  Â  btnEditar.onclick = () => toggleEditar(item.id, textoWrapper, btnEditar);

Â  Â  Â  const btnExcluir = document.createElement('button');
Â  Â  Â  btnExcluir.textContent = 'Excluir';
Â  Â  Â  btnExcluir.onclick = () => excluirTarefa(item.id);

Â  Â  Â  controls.append(btnEditar, btnExcluir);

Â  Â  Â  if (prepend) {
Â  Â  Â  Â  listaTarefas.prepend(li); // Adiciona no inÃ­cio da lista
Â  Â  Â  } else {
Â  Â  Â  Â  listaTarefas.append(li);
Â  Â  Â  }
Â  Â  }

Â  Â  function renderLista(itens) {
Â  Â  Â  listaTarefas.innerHTML = '';
Â  Â  Â  itens.forEach(item => renderItem(item));
Â  Â  }

Â  Â  function toggleEditar(id, textoEl, btnEditar) {
Â  Â  Â  // Verifica se estÃ¡ no modo de ediÃ§Ã£o (botÃ£o diz 'Salvar')
Â  Â  Â  if (btnEditar.dataset.editing === 'true') {
Â  Â  Â  Â  const inputEd = textoEl.querySelector('input');
Â  Â  Â  Â  const novoTitulo = inputEd.value.trim();

Â  Â  Â  Â  if (novoTitulo.length < MIN_CHARS) {
Â  Â  Â  Â  Â  mostrarMensagem(`Erro: digite ao menos ${MIN_CHARS} caracteres.`, 'error');
Â  Â  Â  Â  Â  setTimeout(() => mensagem.className = '', 3000);
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Salva na API e reverte a UI
Â  Â  Â  Â  editarTarefa(id, novoTitulo).then(() => {
Â  Â  Â  Â  Â  btnEditar.textContent = 'Editar';
Â  Â  Â  Â  Â  btnEditar.className = 'edit-btn';
Â  Â  Â  Â  Â  btnEditar.dataset.editing = 'false';
Â  Â  Â  Â  Â  textoEl.textContent = novoTitulo; // Atualiza o texto na UI
Â  Â  Â  Â  });

Â  Â  Â  } else {
Â  Â  Â  Â  // Entra no modo de ediÃ§Ã£o (botÃ£o diz 'Editar')
Â  Â  Â  Â  btnEditar.dataset.editing = 'true';
Â  Â  Â  Â  btnEditar.textContent = 'Salvar';
Â  Â  Â  Â  btnEditar.className = 'save-btn';

Â  Â  Â  Â  const tituloAtual = textoEl.textContent;
Â  Â  Â  Â  const inputEd = document.createElement('input');
Â  Â  Â  Â  inputEd.type = 'text';
Â  Â  Â  Â  inputEd.value = tituloAtual;
Â  Â  Â  Â  inputEd.onkeypress = (e) => {
Â  Â  Â  Â  Â  if (e.key === 'Enter') toggleEditar(id, textoEl, btnEditar);
Â  Â  Â  Â  };

Â  Â  Â  Â  textoEl.innerHTML = '';
Â  Â  Â  Â  textoEl.append(inputEd);
Â  Â  Â  Â  inputEd.focus();
Â  Â  Â  }
Â  Â  }

Â  Â  // --- InicializaÃ§Ã£o ---

Â  Â  btnAdicionar.addEventListener('click', adicionarTarefa);
Â  Â  inputTarefa.addEventListener('keypress', e => { if (e.key === 'Enter') adicionarTarefa(); });

Â  Â  carregarTarefas();
Â  </script>
</body>
</html>
